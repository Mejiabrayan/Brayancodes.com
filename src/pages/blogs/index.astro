---
import Layout from '@/components/Layout.astro';
import { contentfulClient } from '../../lib/contentful';
import type { BlogTypes } from '../../lib/contentful';
import '../../styles/globals.css';
import { ViewTransitions } from 'astro:transitions';

const entries = await contentfulClient.getEntries<BlogTypes>({
  content_type: 'blogPost',
});

const posts = entries.items.map((item) => {
  const { title, date, description, slug } = item.fields;
  return {
    title,
    slug,
    description,
    date: new Date(date).toLocaleDateString(),
  };
});
---

<html lang='en' >
  <head>
    <title>My Blog</title>
    <ViewTransitions />
  </head>
  <Layout title='Brayan M. Cuenca Portfolio'>
    <body class='bg-geist-background'>
      <header class='relative mt-14'>
        <div class='relative text-center py-8'>
          <h1 class='text-4xl font-geist-bold text-accents-8'>My Blog</h1>
        </div>
      </header>

      <div class='container mx-auto px-4' >
        <div class='flex flex-col justify-center items-center text-white'>
          {
            posts.map((post) => (
              <div
                class='rounded-md p-4 my-4'
                transition:name={`blog-title-${post.slug}`}
              >
                
                <a
                  href={`/blogs/${post.slug}/`}
                  class='text-2xl font-geist-mono transition duration-300 ease-in-out hover:text-blue-500'
                >
                  <h2 class='text-accents-7 tracking-tight'>{post.title}</h2>
                </a>
                <time class='text-white'>{post.date}</time>
                <p class='prose prose-sm sm:prose lg:prose-lg xl:prose-xl mt-2 text-accents-7'>
                  {post.description}
                </p>
              </div>
            ))
          }
        </div>
      </div>
    </body>
  </Layout>
</html>
